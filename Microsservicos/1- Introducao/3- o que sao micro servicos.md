Bom, pessoal, no vídeo anterior a gente falou sobre o que são sistemas monolíticos. Quando vale a pena utilizar e principalmente trazer clareza para você, que sistemas monolíticos na maioria das vezes vão atender muito bem o seu negócio. Agora eu quero falar para você sobre microsserviços. Eu não estou querendo falar para você sobre a arquitetura baseada em microsserviços. Eu quero falar especificamente sobre microsserviços.

Então vamos lá, vamos falar sobre esse camarada aqui, deixa eu colar, pera um pouquinho, deixa eu colar esse cara aqui somente para deixar mais claro para vocês organizar, para eu deixar esse material também disponível.

A primeira coisa que eu quero trazer aqui para vocês é o seguinte, o que são microsserviços? microsserviços são aplicações comuns com propósitos e escopo bem definidos. O que isso significa? Significa que microsserviço é um sistema como outro qualquer, ponto. Quando você cria um monolítico, quando você cria um microsserviço, basicamente você está criando a mesma coisa. A diferença é o tamanho, é o nível de responsabilidade do sistema. Diversos sistemas monolíticos, tem diversos escopos. Ele tem diversas responsabilidades, ele tem diversos motivos para mudar. Os microsserviços, normalmente, têm apenas um motivo para mudança. Eu não sei se você já ouviu falar o S do Solid, do Uncle Bob. Ele normalmente fala o seguinte, que o Solid, no final do dia, tem o S, que é o Single Responsibility Principle, e esse cara significa que o seu sistema, o seu componente, tem apenas um motivo para mudança. E eu sei que, normalmente, quando ele se refere a isso, ele se refere a isso dentro de uma classe, principalmente. Mas se você trouxer isso para o macro, com microsserviços é a mesma coisa. Se você tem muitas razões para mudar um microsserviço, é que talvez esse microsserviço, esteja mal dividido, ele esteja fazendo parte de muitos contextos, e nesse caso, ou ele vira um monolítico, ou você arranca de fora esses outros contextos para ele realmente virar um microsserviço. Eu acho que poucas pessoas pensam em microsserviços fazendo essa comparação do S e do Solid. Então, se o seu microsserviço vai atender apenas client support, toda vez que você mudar, ele vai ter que ter a única razão é mudar algo referente a client support. Se ele estiver mudando algo referente a vendas, provavelmente tem algo errado com esse microsserviço e ele está acessando um outro escopo. Por isso que quando nós falamos, inclusive, sobre Domain Driven Design, a gente consegue mapear Bounded Context, ou seja, contextos delimitados, e normalmente esses contextos delimitados trazem para a gente um ponto de partida para você criar o seu microsserviço. Isso não significa que um contexto delimitado é um para um em relação a microsserviços, mas é um ótimo começo para você trabalhar. Então se a sua aplicação tem um propósito bem definido, apenas um escopo para resolver um tipo de problema, normalmente isso vai ser um microsserviço.

Outro ponto importante, os microsserviços têm que ser independentes e autônomos. O que isso significa? Significa que se todos os outros microsserviços caírem, o seu microsserviço tem que estar no ar, esse é o ponto mais complexo. Por quê? Porque é muito complexo você criar um microsserviço sem dependência ao mundo externo. É complexo, mas é possível. E você deve estar se perguntando, “Wesley, como assim eu consigo me manter no ar se o cara que eu dependo está fora do ar?” O ponto é o seguinte, você não pode depender diretamente. “Você não pode depender diretamente de um outro microsserviço”. O que você precisa naquele momento é criar mecanismos de fallback caso o microsserviço que você dependa diretamente estiver fora do ar, pois você vai degradar a entrega que você vai dar para o usuário final. Eu vou dar um exemplo aqui para você. Vamos imaginar que nós estamos fazendo um sistema de um banco e você tem um microsserviço responsável para mostrar o saldo do usuário. Então, na hora que você vai mostrar o saldo do usuário, o cara entrou lá no internet banking, na hora que você vai consultar o saldo, o microsserviço que gera toda a conta para trazer o saldo para você está fora do ar, o que vai acontecer naquele momento? Você vai retornar ali para o cara um erro 500. Você vai retornar ali falando: “não consigo trazer seu saldo?” Então perceba que a experiência que você está trazendo para o usuário é muito ruim. Como você pode manter esse microsserviço funcionando? Você pode pegar o saldo que você consultou pela última vez, sei lá, 10 minutos atrás, 50 segundos atrás e mostrar para o cara, saldo atualizado há 15 segundos. Quando o usuário acessar, ele vai ver que está vendo o saldo atualizado em 15 segundos ou há em um minuto atrás e você conseguiu pelo menos gerar valor para o usuário final. Entende qual a diferença entre você ser autônomo, independente, do que necessariamente você ficar fora do ar por conta de outro microsserviço que você depende? Então quando nós estamos falando de microsserviços, independência de microsserviços, significa que você vai fazer o possível e o impossível para ficar no ar, mesmo que você degrade as suas funcionalidades. É muito interessante, isso normalmente a gente chama de graceful degradation, ou seja, você graciosamente degrada a sua função, mas consegue ainda entregar valor. É difícil fazer? É difícil. É impossível fazer? Não. Você vai fazer isso todas as vezes? Talvez não, mas com certeza em sistemas, em momentos críticos, em informações críticas, você tem que ter essa estratégia para não estourar um erro na cara do cliente. E normalmente quando a gente está falando em microsserviços, significa que você está criando um sistema que faz parte de um sistema maior. Ele ajuda uma engrenagem maior a rodar.

Então, os microsserviços sempre vão ser parte de uma engrenagem maior. Se você está criando um sistema, mesmo que esse sistema seja muito pequeno, mas em volta dele não tem um ecossistema, você não está criando um microsserviço, você está criando um sistema monolítico, que é pequeno e que tem pouca responsabilidade naquele momento. Então,  toda vez que a gente vai falar sobre microsserviços, é inerente a gente falar sobre a arquitetura baseada em microsserviços, que a gente já vai falar logo em seguida. Mas pense sempre dessa forma, microsserviço tem um escopo definido, é independente e autônomo e faz parte de um sistema maior. Ele faz parte de uma engrenagem maior e normalmente a comunicação desse cara é mais complexa e é super importante você degradar o serviço quando as dependências dele estão fora. Espero que eu tenha trazido algum insight aqui para vocês. Muita gente que já trabalha com microsserviços pode pensar que eu estou “chovendo no molhado”, mas sempre tem algo que vai fazer você pensar duas vezes. Um grande abraço para você e até o nosso próximo vídeo.