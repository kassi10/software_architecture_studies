Bom, pessoal, continuando com a nossa tangente aqui, agora eu quero falar com vocês sobre essas mini API gateways. Essas mini ou micro gateways… Eu vou pegar aqui para deixar um pouco mais claro isso para vocês, que essas micro ou mini gateways são exatamente esses caras aqui que eu estou trabalhando. Porque eles têm um objetivo muito claro aqui de fazer roteamento de tráfego, então, quando eles roteiam esse tráfego aqui, eles estão funcionando basicamente como um balanceador de carga. Não é um balanceador de carga, é um proxy reverso aqui para a gente. Não que as enterprise gateways também não funcionem como um proxy reverso.

Agora, um ponto importante que você vai começar a perceber é que a maioria desses tipos de gateway não possuem um painel de controle, não possuem um local lá que o desenvolvedor vai, que o gestor de APIs, o time de APIs vai lá e cadastra diversas rotas. Ou vai lá, clica e faz um monte de coisa. Normalmente, essas APIs, essas mini gateways, são configuradas de forma declarativa dentro de uma configuração. Normalmente, você expõe um arquivo, coloca lá para o Kubernetes subir, lê esse arquivo e está tudo certo. Então, não há sistema de administração de APIs, normalmente a equipe precisa configurar os endpoints e fazer o deploy para cada mudança. Agora, aqui está o negócio, normalmente, essas micro gateways, de forma geral, não armazenam estado. Elas não precisam chamar e não tem dependência externa, e isso é uma maravilha, porque você pode derrubar, pode subir quantas vezes quiser. Você não depende de banco de dados externo, você não tem problema ali de indisponibilidade e consistência, como a gente falou em relação das enterprise gateways.

E aqui, você não vai ter suporte a múltiplos ambientes. Ou se você quiser ter suporte a múltiplos ambientes, você vai ter que sair criando um monte de mini gateways. Você vai ter que criar diversos micro gateways (Deixa eu até colocar aqui, ou seja, vai dar mais trabalho). E aqui, você não possui vendor lock-in, porque na maioria das vezes, esses tipos de gateways aqui são open source. E aqui, como eu falei para vocês, ela roda standalone. Ela não precisa de banco de dados, não precisa de cache. Você sobe, e ela simplesmente está funcionando. É o seguinte, para esses tipos de situação, como eu mostrei aqui, você não precisa de uma enterprise gateway. Aqui com o software open source para subir uma mini gateway aqui, você está feliz e contente. “Ah, vou precisar subir mais endpoints, etc.” Vai lá de forma declarativa, faz o deploy, dá para passar para um CI/CD, ela sobe, ela reinicia e está tudo certo. Então, normalmente, nesses contextos, essas mini gateways, essas micro gateways vão funcionar melhor e com custo extremamente mais baixo, porque normalmente você vai encontrar soluções open source.

Normalmente as enterprise gateways vão ser mais caras. Elas vão ter um escopo muito maior para trazer resultados. E você vai ter um setup muito maior. Você vai precisar de fazer integrações, então, tem muita coisa ali por trás. Eu não estou desencorajando você a utilizar enterprise gateways, porque elas fazem muito, mas muito sentido em muitos cenários, principalmente quando você quer fazer integração de contextos, mas também expor tudo isso para a internet com um contexto ainda muito mais claro. Então aqui, por exemplo, (deixa eu até colocar aqui) eu vou colocar aqui na frente uma enterprise gateway aqui para você poder olhar. E aqui, no final do dia, a gente vai ter, opa, não está colocado aqui… no final do dia você vai ter as chamadas externas das aplicações e essas enterprise gateways aqui vão apontar para apontar para as micro gateways.

(Deixa eu colocar aqui). E essas micro gateways chamam os microsserviços, então, perceba que nem a enterprise gateway sabe diretamente qual serviço, qual microsserviço chamar. Ela sabe qual é o escopo que ela vai chamar e aqui a gente vai ter diversas URLs. Então, eu posso ter um /bill aqui também, um /charge, para cobrar alguma coisa e quando chamar esse cara, ela vem aqui, (deixa eu até mandar para esse cara aqui)... e ela vai bater nesse cara e esse cara vai chamar esse cara aqui. Então, é importante que você consiga entender bem essa estrutura para cada vez ficar mais fácil de você organizar os seus microsserviços.

São esses tipos de coisas que não te contam sobre microsserviços. São esses tipos de coisa que vão fazer um baita diferencial na sua carreira quando você for organizar uma arquitetura baseada em microsserviços. Perceba que “o buraco é muito mais embaixo” do que você imagina, do que apenas uma coisa fazendo a chamada de outra. Tem muita coisa aqui por aqui e eu espero que você tenha curtido esses tipos de solução porque são opções que você pode utilizar no dia a dia. Um grande abraço e é isso!